{# templates/index.html #}
{% extends 'base.html' %}
{% set active = 'index' %}

{% block content %}
    <h1>Convert Column to Comma-Separated List</h1>
    <p>free tool to turn column data into comma-separated lists for CSVs, SQL IN-clauses, code snippets, and more</p>

    <div class="flex-container">
        <div>
            <h2>Input:</h2>
            <form method="POST">      
              <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
              <div class="form-row">
                    <label for="delimiter">delimiter:</label>
                    <input id="delimiter" type="text" name="delimiter" value="{{ delimiter or ',' }}" />
                  </div>
                  
                  <div class="form-row">
                    <label for="item_prefix">item prefix:</label>
                    <input id="item_prefix" type="text" name="item_prefix" value="{{ item_prefix or '' }}" />
                  </div>
                  
                  <div class="form-row">
                    <label for="item_suffix">item suffix:</label>
                    <input id="item_suffix" type="text" name="item_suffix" value="{{ item_suffix or '' }}" />
                  </div>
                  
                  <div class="form-row">
                    <label for="result_prefix">result prefix:</label>
                    <input id="result_prefix" type="text" name="result_prefix" value="{{ result_prefix or '' }}" />
                  </div>
                  
                  <div class="form-row">
                    <label for="result_suffix">result suffix:</label>
                    <input id="result_suffix" type="text" name="result_suffix" value="{{ result_suffix or '' }}" />
                  </div>
                  <div class="form-row">
                    <label for="sort_order">sort lines:</label>
                    <select id="sort_order" name="sort_order">
                      <option value=""   {% if not sort_order %}selected{% endif %}>none</option>
                      <option value="asc"  {% if sort_order=='asc' %}selected{% endif %}>A → Z</option>
                      <option value="desc" {% if sort_order=='desc' %}selected{% endif %}>Z → A</option>
                    </select>
                  </div>
                  <div class="form-row">
                    <label for="dedupe">de-dupe?:</label>
                    <input
                      id="dedupe"
                      type="checkbox"
                      name="dedupe"
                      {% if dedupe %}checked{% endif %}
                    />
                  </div>   
                <br>
                <button type="submit" class="primary"  >Convert</button>
                <br><br>
                <textarea name="column_data" rows="25" cols="50" placeholder="Paste your column here...">{{ column_text or '' }}</textarea><br>
            
            </form>
                  
        </div>

        <div>
            <h2>Result:</h2>
            <!-- type="button" so it doesn't submit the form -->
            <button type="button" class="primary" id="copy-btn">Copy to clipboard</button>
            <br><br>
            <!-- add an id so JS can grab it -->
            <textarea id="result-textarea"
                      rows="25" cols="50"
                      readonly
            >{% if result %}{{ result }}{% endif %}</textarea>

          </div>
    </div>
    <script>
        const copyBtn  = document.getElementById('copy-btn');
        const resultTa = document.getElementById('result-textarea');
      
        copyBtn.addEventListener('click', () => {
          const text = resultTa.value.trim();
          if (!text) return;              // nothing to copy
      
          navigator.clipboard
            .writeText(text)              // write to clipboard
            .then(() => {
              copyBtn.textContent = 'Copied!';
              // reset button text after 2s
              setTimeout(() => { copyBtn.textContent = 'Copy to clipboard'; }, 2000);
            })
            .catch(err => {
              console.error('Copy failed:', err);
              copyBtn.textContent = 'Error';
            });
        });
      </script>
{% endblock %}
