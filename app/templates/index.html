<!DOCTYPE html>
<html>
<head>
    <title>convert.blue</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="icon"
    type="image/x-icon"
    href="{{ url_for('static', filename='favicon.ico') }}" />
</head>
<body>
    <h1>Convert Column to Comma-Separated List</h1>

    <div class="flex-container">
        <div>
            <h2>Input:</h2>
            <form method="POST">            
                <label>delimiter:
                    <input type="text" name="delimiter" value="{{ delimiter or ',' }}" />
                </label><br>
                <label>item prefix:
                    <input type="text" name="item_prefix" value="{{ item_prefix or '' }}" />
                </label><br>
                <label>item suffix:
                    <input type="text" name="item_suffix" value="{{ item_suffix or '' }}" />
                </label><br>
                <label>result prefix:
                    <input type="text" name="result_prefix" value="{{ result_prefix or '' }}" />
                </label><br>
                <label>result suffix:
                    <input type="text" name="result_suffix" value="{{ result_suffix or '' }}" />
                </label><br>
                <label>
                    <input
                      type="checkbox"
                      name="dedupe"
                      {% if dedupe %}checked{% endif %}
                    />
                    de-dupe?
                  </label><br>                  
                <br>
                <button type="submit" class="primary"  >Convert</button>
                <br><br>
                <textarea name="column_data" rows="25" cols="40" placeholder="Paste your column here...">{{ column_text or '' }}</textarea><br>
            
            </form>
                  
        </div>

        <div>
            <h2>Result:</h2>
            <!-- type="button" so it doesn't submit the form -->
            <button type="button" class="primary" id="copy-btn">Copy to clipboard</button>
            <br><br>
            <!-- add an id so JS can grab it -->
            <textarea id="result-textarea"
                      rows="25" cols="40"
                      readonly
            >{% if result %}{{ result }}{% endif %}</textarea>

          </div>
    </div>
    <script>
        const copyBtn  = document.getElementById('copy-btn');
        const resultTa = document.getElementById('result-textarea');
      
        copyBtn.addEventListener('click', () => {
          const text = resultTa.value.trim();
          if (!text) return;              // nothing to copy
      
          navigator.clipboard
            .writeText(text)              // write to clipboard
            .then(() => {
              copyBtn.textContent = 'Copied!';
              // reset button text after 2s
              setTimeout(() => { copyBtn.textContent = 'Copy to clipboard'; }, 2000);
            })
            .catch(err => {
              console.error('Copy failed:', err);
              copyBtn.textContent = 'Error';
            });
        });
      </script>
      
</body>
</html>
